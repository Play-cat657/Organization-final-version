<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Estuda+</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#4f46e5;
  --bg:#f4f6f8;
  --card:#ffffff;
  --text:#1f2937;
  --success:#22c55e;
}

body.dark{
  --bg:#0f172a;
  --card:#1e293b;
  --text:#f8fafc;
}

body{
  margin:0;
  font-family:system-ui, sans-serif;
  background:var(--bg);
  color:var(--text);
}

header{
  background:linear-gradient(135deg,var(--primary),#3730a3);
  color:white;
  padding:20px;
  text-align:center;
  font-size:26px;
  font-weight:bold;
}

nav{
  display:flex;
  justify-content:center;
  gap:8px;
  background:#e0e7ff;
  padding:10px;
  flex-wrap:wrap;
}

nav button{
  padding:10px 14px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

nav button.active{
  background:var(--primary);
  color:white;
}

.container{padding:20px}
.section{display:none}
.section.active{display:block}

.card{
  background:var(--card);
  padding:20px;
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.15);
  max-width:460px;
  margin:auto;
}

h2{text-align:center;margin-top:0}

/* Agenda */
.agenda input{
  width:100%;
  padding:10px;
  margin-bottom:8px;
  border-radius:8px;
  border:1px solid #c7d2fe;
}

.agenda li{
  list-style:none;
  background:#e0e7ff;
  padding:10px;
  margin-bottom:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-radius:8px;
}

.done{
  text-decoration:line-through;
  opacity:.6;
}

/* Calend√°rio */
.calendar table{
  width:100%;
  border-collapse:collapse;
}

.calendar th,.calendar td{
  padding:8px;
  border:1px solid #94a3b8;
  text-align:center;
  cursor:pointer;
}

.selected{
  background:var(--primary);
  color:white;
}

/* Cron√≥metro */
.timer{
  font-size:42px;
  text-align:center;
  margin:15px 0;
}

/* Gr√°ficos */
canvas{
  width:100%;
  max-width:400px;
  display:block;
  margin:20px auto;
}
</style>
</head>

<body>

<header>üìö Estuda+</header>

<nav>
  <button class="active" onclick="show('agenda',this)">üìù Agenda</button>
  <button onclick="show('calendar',this)">üìÖ Calend√°rio</button>
  <button onclick="show('timer',this)">‚è±Ô∏è Cron√≥metro</button>
  <button onclick="show('stats',this)">üìä Stats</button>
  <button onclick="show('settings',this)">‚öôÔ∏è</button>
</nav>

<div class="container">

<!-- AGENDA -->
<div id="agenda" class="section active">
  <div class="card agenda">
    <h2 id="dayTitle"></h2>
    <input id="taskText" placeholder="Nova tarefa">
    <input id="taskTime" type="time">
    <button onclick="addTask()">Adicionar</button>
    <ul id="taskList"></ul>
  </div>
</div>

<!-- CALEND√ÅRIO -->
<div id="calendar" class="section">
  <div class="card calendar">
    <h2 id="monthYear"></h2>
    <div id="cal"></div>
  </div>
</div>

<!-- CRON√ìMETRO -->
<div id="timer" class="section">
  <div class="card">
    <h2>Cron√≥metro</h2>
    <label>Minutos</label>
    <input id="minutes" type="number" value="25">
    <div class="timer" id="display">25:00</div>
    <button onclick="startTimer()">‚ñ∂Ô∏è</button>
    <button onclick="pauseTimer()">‚è∏Ô∏è</button>
    <button onclick="resetTimer()">‚èπÔ∏è</button>
  </div>
</div>

<!-- STATS -->
<div id="stats" class="section">
  <div class="card">
    <h2>Estat√≠sticas</h2>
    <canvas id="bar"></canvas>
  </div>
</div>

<!-- DEFINI√á√ïES -->
<div id="settings" class="section">
  <div class="card">
    <button onclick="toggleDark()">üåô Modo escuro</button>
  </div>
</div>

</div>

<script>
/* Navega√ß√£o */
function show(id,btn){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  btn.classList.add('active');
  if(id==="stats")drawChart();
}

/* Agenda por dia */
let selectedDate=new Date().toISOString().split("T")[0];
let data=JSON.parse(localStorage.getItem("agenda")||"{}");

function renderAgenda(){
  dayTitle.innerText="üìÖ "+selectedDate;
  taskList.innerHTML="";
  (data[selectedDate]||[]).forEach((t,i)=>{
    let li=document.createElement("li");
    li.innerHTML=`
      <span class="${t.done?'done':''}">${t.time} - ${t.text}</span>
      <button onclick="toggleTask(${i})">‚úîÔ∏è</button>`;
    taskList.appendChild(li);
  });
}

function addTask(){
  if(!taskText.value||!taskTime.value)return;
  data[selectedDate]=data[selectedDate]||[];
  data[selectedDate].push({text:taskText.value,time:taskTime.value,done:false});
  save();
}

function toggleTask(i){
  data[selectedDate][i].done=!data[selectedDate][i].done;
  save();
}

function save(){
  localStorage.setItem("agenda",JSON.stringify(data));
  renderAgenda();
}

/* Calend√°rio clic√°vel */
function buildCalendar(){
  const d=new Date(selectedDate);
  const y=d.getFullYear(),m=d.getMonth();
  monthYear.innerText=d.toLocaleString("pt-PT",{month:"long",year:"numeric"});
  let first=new Date(y,m,1).getDay();
  let days=new Date(y,m+1,0).getDate();
  let html="<table><tr>";
  ["D","S","T","Q","Q","S","S"].forEach(x=>html+=`<th>${x}</th>`);
  html+="</tr><tr>";
  for(let i=0;i<first;i++)html+="<td></td>";
  for(let day=1;day<=days;day++){
    let date=`${y}-${String(m+1).padStart(2,"0")}-${String(day).padStart(2,"0")}`;
    html+=`<td class="${date===selectedDate?'selected':''}" onclick="selectDate('${date}')">${day}</td>`;
    if((day+first)%7===0)html+="</tr><tr>";
  }
  cal.innerHTML=html;
}

function selectDate(d){
  selectedDate=d;
  buildCalendar();
  renderAgenda();
  show('agenda',document.querySelector('nav button'));
}

/* Cron√≥metro */
let seconds=0,interval=null;
function startTimer(){
  if(interval)return;
  if(seconds===0)seconds=minutes.value*60;
  interval=setInterval(()=>{
    seconds--;
    display.innerText=`${Math.floor(seconds/60)}:${String(seconds%60).padStart(2,"0")}`;
    if(seconds<=0)pauseTimer();
  },1000);
}
function pauseTimer(){clearInterval(interval);interval=null;}
function resetTimer(){pauseTimer();seconds=minutes.value*60;display.innerText=minutes.value+":00";}

/* Estat√≠sticas */
function drawChart(){
  let done=0,total=0;
  Object.values(data).forEach(d=>{
    total+=d.length;
    done+=d.filter(t=>t.done).length;
  });
  const ctx=bar.getContext("2d");
  ctx.clearRect(0,0,400,200);
  ctx.fillStyle="#22c55e";
  ctx.fillRect(80,180-done*15,60,done*15);
  ctx.fillStyle="#94a3b8";
  ctx.fillRect(180,180-(total-done)*15,60,(total-done)*15);
}

/* Dark */
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("dark",document.body.classList.contains("dark"));
}
if(localStorage.getItem("dark")==="true")document.body.classList.add("dark");

buildCalendar();
renderAgenda();
resetTimer();
</script>

</body>
</html>
