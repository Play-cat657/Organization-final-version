<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<title>Estuda+</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#6366f1;
  --bg:#f1f5f9;
  --card:#ffffff;
  --text:#0f172a;
}
body.dark{
  --bg:#020617;
  --card:#0f172a;
  --text:#f8fafc;
}
body{
  margin:0;
  font-family:system-ui,sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  background:var(--primary);
  color:white;
  padding:20px;
  text-align:center;
  font-size:26px;
  font-weight:bold;
}
nav{
  display:flex;
  gap:8px;
  justify-content:center;
  padding:10px;
  flex-wrap:wrap;
}
nav button{
  padding:10px 14px;
  border:none;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}
nav button.active{
  background:var(--primary);
  color:white;
}
.container{padding:20px}
.section{display:none}
.section.active{display:block}
.card{
  background:var(--card);
  padding:20px;
  border-radius:18px;
  box-shadow:0 15px 30px rgba(0,0,0,.15);
  max-width:520px;
  margin:auto;
}
h2{text-align:center}

/* Agenda */
.agenda input, select{
  width:100%;
  padding:10px;
  margin-bottom:8px;
}
.agenda li{
  list-style:none;
  padding:10px;
  margin-bottom:6px;
  border-radius:10px;
  background:#e0e7ff;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.done{text-decoration:line-through;opacity:.6}

/* Calend√°rio */
.calendar td{
  padding:10px;
  text-align:center;
  cursor:pointer;
}
.selected{
  background:var(--primary);
  color:white;
  border-radius:8px;
}

/* Pomodoro */
.timer{
  font-size:48px;
  text-align:center;
  margin:20px 0;
}

/* Stats */
.stats div{
  padding:10px;
  background:#e0e7ff;
  margin-bottom:8px;
  border-radius:10px;
}
</style>
</head>

<body>

<header>üìö Estuda+</header>

<nav>
  <button class="active" onclick="show('agenda',this)">üìù Agenda</button>
  <button onclick="show('calendar',this)">üìÖ</button>
  <button onclick="show('week',this)">üìÜ Semana</button>
  <button onclick="show('pomodoro',this)">‚è±Ô∏è</button>
  <button onclick="show('stats',this)">üìä</button>
  <button onclick="show('settings',this)">‚öôÔ∏è</button>
</nav>

<div class="container">

<!-- AGENDA -->
<div id="agenda" class="section active">
  <div class="card agenda">
    <h2 id="dayTitle"></h2>
    <input id="taskText" placeholder="Tarefa">
    <input id="taskTime" type="time">
    <button onclick="addTask()">Adicionar</button>
    <ul id="taskList"></ul>
  </div>
</div>

<!-- CALEND√ÅRIO -->
<div id="calendar" class="section">
  <div class="card calendar">
    <h2 id="monthYear"></h2>
    <div id="cal"></div>
  </div>
</div>

<!-- SEMANA -->
<div id="week" class="section">
  <div class="card">
    <h2>üìÜ Vista Semanal</h2>
    <ul id="weekView"></ul>
  </div>
</div>

<!-- POMODORO -->
<div id="pomodoro" class="section">
  <div class="card">
    <h2>‚è±Ô∏è Pomodoro</h2>
    <div class="timer" id="timer">25:00</div>
    <button onclick="startPomodoro()">‚ñ∂Ô∏è Iniciar</button>
    <button onclick="stopPomodoro()">‚èπÔ∏è Parar</button>
  </div>
</div>

<!-- STATS -->
<div id="stats" class="section">
  <div class="card stats">
    <h2>üìä Estat√≠sticas</h2>
    <div id="total"></div>
    <div id="done"></div>
    <div id="percent"></div>
  </div>
</div>

<!-- SETTINGS -->
<div id="settings" class="section">
  <div class="card">
    <button onclick="toggleDark()">üåô Modo escuro</button>
  </div>
</div>

</div>

<script>
let selectedDate=new Date().toISOString().split("T")[0];
let data=JSON.parse(localStorage.getItem("agenda")||"{}");

/* Navega√ß√£o */
function show(id,btn){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b=>b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  if(btn)btn.classList.add('active');
}

/* Agenda */
function renderAgenda(){
  dayTitle.innerText="üìÖ "+selectedDate;
  taskList.innerHTML="";
  (data[selectedDate]||[]).forEach((t,i)=>{
    let li=document.createElement("li");
    li.innerHTML=`
      <span class="${t.done?'done':''}">${t.time} - ${t.text}</span>
      <div>
        <button onclick="toggleTask(${i})">‚úîÔ∏è</button>
        <button onclick="removeTask(${i})">‚ùå</button>
      </div>`;
    taskList.appendChild(li);
  });
  updateStats();
}
function addTask(){
  if(!taskText.value||!taskTime.value)return;
  data[selectedDate]=data[selectedDate]||[];
  data[selectedDate].push({text:taskText.value,time:taskTime.value,done:false});
  save();
}
function toggleTask(i){
  data[selectedDate][i].done=!data[selectedDate][i].done;
  save();
}
function removeTask(i){
  data[selectedDate].splice(i,1);
  save();
}
function save(){
  localStorage.setItem("agenda",JSON.stringify(data));
  renderAgenda();
  renderWeek();
}

/* Calend√°rio */
function buildCalendar(){
  const d=new Date(selectedDate);
  const y=d.getFullYear(),m=d.getMonth();
  monthYear.innerText=d.toLocaleString("pt-PT",{month:"long",year:"numeric"});
  let first=new Date(y,m,1).getDay();
  let days=new Date(y,m+1,0).getDate();
  let html="<table><tr>";
  ["D","S","T","Q","Q","S","S"].forEach(x=>html+=`<th>${x}</th>`);
  html+="</tr><tr>";
  for(let i=0;i<first;i++)html+="<td></td>";
  for(let day=1;day<=days;day++){
    let date=`${y}-${String(m+1).padStart(2,"0")}-${String(day).padStart(2,"0")}`;
    html+=`<td class="${date===selectedDate?'selected':''}"
    onclick="selectDate('${date}')">${day}</td>`;
    if((day+first)%7===0)html+="</tr><tr>";
  }
  cal.innerHTML=html;
}
function selectDate(d){
  selectedDate=d;
  buildCalendar();
  renderAgenda();
  show('agenda',document.querySelector('nav button'));
}

/* Semana */
function renderWeek(){
  weekView.innerHTML="";
  for(let i=0;i<7;i++){
    let d=new Date();
    d.setDate(d.getDate()+i);
    let key=d.toISOString().split("T")[0];
    let count=(data[key]||[]).length;
    let li=document.createElement("li");
    li.innerText=`${key} ‚Üí ${count} tarefas`;
    weekView.appendChild(li);
  }
}

/* Pomodoro */
let time=1500,interval;
function startPomodoro(){
  if(Notification.permission!=="granted")Notification.requestPermission();
  interval=setInterval(()=>{
    time--;
    timer.innerText=`${Math.floor(time/60)}:${String(time%60).padStart(2,"0")}`;
    if(time===0){
      new Notification("Pomodoro conclu√≠do!");
      stopPomodoro();
      time=300;
    }
  },1000);
}
function stopPomodoro(){
  clearInterval(interval);
}

/* Stats */
function updateStats(){
  let total=0,done=0;
  Object.values(data).forEach(d=>{
    total+=d.length;
    done+=d.filter(x=>x.done).length;
  });
  totalDiv.innerText=`Total tarefas: ${total}`;
  doneDiv.innerText=`Conclu√≠das: ${done}`;
  percent.innerText=`Produtividade: ${total?Math.round(done/total*100):0}%`;
}

/* Dark */
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("dark",document.body.classList.contains("dark"));
}
if(localStorage.getItem("dark")==="true")document.body.classList.add("dark");

buildCalendar();
renderAgenda();
renderWeek();
</script>

</body>
</html>
